import{customElementsPrefix}from"./Defines.js";export class Layers extends HTMLElement{constructor(){super()}init(){this.classList.add("layer-wrapper"),this.__addLayer(LayerName.frame),this.__addLayer(LayerName.processData),this.__addLayer(LayerName.syncUnit),this.__addLayer(LayerName.text),this.__addLayer(LayerName.error),this.__addLayer(LayerName.hover)}connectedCallback(){this.resizeEvent()}__translation=[{x:0,y:0}];get translation(){return this.__translation[0]}reset(){this.setFocusedZoomAndShift(1,{x:0,y:0})}__zoomLevel=1;__shift={x:0,y:0};__layers=new Map;__addLayer(layerName){const canvas=document.createElement("canvas");this.append(canvas);const ctx=canvas.getContext("2d");ctx?this.__layers.set(layerName,ctx):TcHmi.Log.errorEx("Error while getting context of canvas.")}getCanvas(name){return this.__layers.get(name).canvas}getContext(name){return this.__layers.get(name)}resizeEvent(){const offsetWidth=this.offsetWidth,offsetHeight=this.offsetHeight,width=offsetWidth*window.devicePixelRatio,height=offsetHeight*window.devicePixelRatio;for(const ctx of this.__layers.values()){const canvas=ctx.canvas;canvas.width=width,canvas.height=height,canvas.style.width=`${offsetWidth}px`,canvas.style.height=`${offsetHeight}px`}}translateAll(x,y){this.__translation[0]={x:this.__translation[0].x+x,y:this.__translation[0].y+y};for(const ctx of this.__layers.values())ctx.translate(x,y)}setFocusedZoomAndShift(zoomLevel,shift){this.__zoomLevel=zoomLevel,this.__shift=shift,zoomLevel*=window.devicePixelRatio;for(const ctx of this.__layers.values())ctx.setTransform(zoomLevel,0,0,zoomLevel,shift.x,shift.y)}setFocusedShift(shift){this.setFocusedZoomAndShift(this.__zoomLevel,shift)}setFocusedZoom(zoomLevel){this.setFocusedZoomAndShift(zoomLevel,this.__shift)}setBackgroundZoom(zoomLevel){}showAllLayer(){for(const ctx of this.__layers.values())ctx.canvas.classList.remove("hide")}hideAllLayers(){for(const ctx of this.__layers.values()){const canvas=ctx.canvas;canvas.classList.add("hide"),ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.restore()}}setTransparency(transparency=1){for(const ctx of this.__layers.values())ctx.globalAlpha=transparency}saveContext(){this.__translation.unshift(this.__translation[0]);for(const ctx of this.__layers.values())ctx.save()}restoreContext(){this.__translation.shift();for(const ctx of this.__layers.values())ctx.restore()}erase(name){if(name)this.__eraseContext(this.getContext(name));else{this.__translation=[{x:0,y:0}];for(const ctx of this.__layers.values())this.__eraseContext(ctx)}}__eraseContext(ctx){const canvas=ctx.canvas;ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.restore()}destroy(){for(const ctx of this.__layers.values())ctx.canvas.remove();this.__layers.clear()}}customElements.define(customElementsPrefix+"drawing-layers",Layers);export var LayerName;!function(LayerName){LayerName[LayerName.frame=0]="frame",LayerName[LayerName.processData=1]="processData",LayerName[LayerName.text=2]="text",LayerName[LayerName.syncUnit=3]="syncUnit",LayerName[LayerName.error=4]="error",LayerName[LayerName.hover=5]="hover"}(LayerName||(LayerName={}));