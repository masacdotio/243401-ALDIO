import{Master}from"./Master.js";import{Slave}from"./Slave.js";import{PortPhysic,PortName}from"./Port.js";import"./WebComponents/StatusButton/StatusButton.js";import{SlaveListView}from"./WebComponents/SlaveListView/SlaveListView.js";import{ProcessDataView}from"./WebComponents/ProcessDataView/ProcessDataView.js";import{removeGarbageElements,addDomElement}from"./DOMUtility.js";import{extensionName}from"./Defines.js";import{DrawingSlave}from"./DrawingSlave.js";import{DrawingTrace}from"./DrawingTrace.js";export class ExtendedInfo{constructor(master,component){this.__master=master,this.__component=component,this.__tabName=this.__master.getExtendedInfoTabName(this.__component)}__component;__popUp=null;__tabName;__master;__open(popUp){this.__popUp=popUp,this.__master.main.addPopUp(popUp)}destroy(){this.__popUp?.remove(),this.__popUp?.close(),this.__popUp=null,this.__popup_param?.content?.remove(),this.__popup_param=null,this.__master.target.main.getLocalization().cleanUp()}close(){this.destroy()}__popup_param=null;getScrollTop(){return this.__popUp?.getScrollTop()}setScrollTop(scrollTop){this.__popUp?.setScrollTop(scrollTop)}}export class ExtendedInfoOfMaster extends ExtendedInfo{constructor(master){super(master,"Master"),this.__open(),this.createSlaveList(),this.__master.updateMasterOnlineInfo(null),this.__master.updateSlavesOnlineInfo(null)}destroy(){super.destroy(),this.__masterContentTabs?.remove(),this.__masterContentTabs=null,this.__master.removeExtendedInfoOfMaster(this),removeGarbageElements("ExtendedInfoOfMaster")}__masterContentTabs=null;__open(){const content=this.__master.main.getTemplate("popup-master"),localization=this.__master.target.main.getLocalization();if(!content)return void TcHmi.Log.error("Content is not defined");if(this.__masterContentTabs=content.querySelector("tchmi-content-tabs"),!this.__masterContentTabs)return void TcHmi.Log.warn("Element 'tchmi-content-tabs' not found");this.__masterContentTabs.addTabChangeCallback(tabName=>{this.__master.setExtendedInfoTabName("Master",tabName)}),this.__tabName&&this.__masterContentTabs.openTab(this.__tabName);const target=this.__master.target;content.querySelector(".target-name").textContent=target.name,content.querySelector(".target-netId").textContent=target.netId,content.querySelector(".master-name").textContent=this.__master.name,content.querySelector(".master-netId").textContent=this.__master.netId;const firstComponent=this.__master.ports[1]?.configuredComponent;if(firstComponent instanceof Slave){const btn=document.createElement("div");btn.classList.add("navigation-link"),firstComponent.name&&(btn.innerHTML=firstComponent.name),btn.addEventListener("click",()=>{this.__master.setExtendedInfoOfSlave(new ExtendedInfoOfSlave(firstComponent))}),content.querySelector(".master-first-port").append(btn)}const redundancyComponent=this.__master.ports[0]?.configuredComponent;if(redundancyComponent instanceof Slave){const btn=document.createElement("span");btn.classList.add("navigation-link"),redundancyComponent.name&&(btn.innerHTML=redundancyComponent.name),btn.addEventListener("click",()=>{this.__master.setExtendedInfoOfSlave(new ExtendedInfoOfSlave(redundancyComponent))}),content.querySelector(".master-redundancy-port").append(btn)}else content.querySelector(".master-redundancy-port").innerHTML="No redundancy slave configured";if(this.__master.main.getSymbolAccess(`${extensionName}.ClearFrames`)){const clearFramesBtn=content.querySelector('[name="clearFrames"]'),clearFramesCbErrorWrapper=content.querySelector('[name="clearFramesCbErrorWrapper"]');clearFramesBtn&&clearFramesCbErrorWrapper&&(clearFramesBtn.init(this.__master.main),clearFramesBtn.classList.remove("hide"),clearFramesCbErrorWrapper.classList.remove("hide"),clearFramesBtn.addEventListener("click",()=>{this.__master.target.main.comObj?.writeSymbol(`${extensionName}.ClearFrames`,this.__master.main.config.device,void 0,{button:clearFramesBtn,message:clearFramesCbErrorWrapper})}))}if(this.__master.main.getSymbolAccess(`${extensionName}.ClearCrc`)){const clearDamagedFramesBtn=content.querySelector('[name="clearDamagedFrames"]'),clearDamagedFramesCbErrorWrapper=content.querySelector('[name="clearDamagedFramesCbErrorWrapper"]');clearDamagedFramesBtn&&clearDamagedFramesCbErrorWrapper?(clearDamagedFramesBtn.init(this.__master.main),clearDamagedFramesBtn.classList.remove("hide"),clearDamagedFramesCbErrorWrapper.classList.remove("hide"),clearDamagedFramesBtn.addEventListener("click",()=>{this.__master.target.main.comObj?.writeSymbol(`${extensionName}.ClearCrc`,this.__master.main.config.device,()=>{},{button:clearDamagedFramesBtn,message:clearDamagedFramesCbErrorWrapper})})):TcHmi.Log.errorEx('Template.html is invalid. Element [name="clearDamagedFrames"] or [name="clearDamagedFramesCbErrorWrapper"] not found.')}const masterSetStateContainer=content.querySelector(".master-setState-container");if(masterSetStateContainer&&this.__master.main.getSymbolAccess(`${extensionName}.SetMasterStateMachine`)){masterSetStateContainer.classList.remove("hide");const masterSetStateValue=masterSetStateContainer.querySelector('[name="master-setState-value"]'),masterSetStateBtn=masterSetStateContainer.querySelector('[name="master-setState-btn"]');masterSetStateValue&&masterSetStateBtn&&(masterSetStateBtn.init(this.__master.main),masterSetStateBtn.addEventListener("click",()=>{parseInt(masterSetStateValue.value,10)&&this.__master.target.main.comObj?.writeSymbol(`${extensionName}.SetMasterStateMachine`,{device:this.__master.main.config.device,state:parseInt(masterSetStateValue.value,10)},()=>{masterSetStateValue.value="0"},{button:masterSetStateBtn})}))}else masterSetStateContainer?.classList.add("hide");const onlineData=this.__master.data.online;addDomElement("ExtendedInfoOfMaster",onlineData.stateMachine.name,content.querySelector(".master-currentState-name")),addDomElement("ExtendedInfoOfMaster",onlineData.stateMachineRequested.name,content.querySelector(".master-requestedState-name")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.total.cyclic,content.querySelector(".sendFrames-cyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.total.acyclic,content.querySelector(".sendFrames-acyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.perSec.cyclic,content.querySelector(".framesPerSec-cyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.perSec.acyclic,content.querySelector(".framesPerSec-acyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.missed.cyclic,content.querySelector(".lostFrames-cyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.missed.acyclic,content.querySelector(".lostFrames-acyclic")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.damaged.sent,content.querySelector(".damagedFrames-sent")),addDomElement("ExtendedInfoOfMaster",onlineData.frames.damaged.received,content.querySelector(".damagedFrames-received"));const content_slaveList=content.querySelector('[name="slave-list"]');if(!content_slaveList)return void TcHmi.Log.warn('Element [tab="slave-list"] not found.');const slaveListView=new SlaveListView(this.__master,localization);content_slaveList.append(slaveListView);const content_syncunit=content.querySelector('[name="syncunits"]');if(!content_syncunit)return void TcHmi.Log.warnEx('Element [tab="syncunits"] not found.');const content_syncunit_list=content_syncunit.querySelector("tbody.syncunit-list");if(!content_syncunit_list)return void TcHmi.Log.warnEx("Element tbody.syncunit-list not found.");const syncUnits=this.__master.syncUnits.getAll(),selectedSyncUnit=this.__master.selectedSyncUnit,noSyncUnit=content_syncunit_list.querySelector("input.no-sync-unit");if(!noSyncUnit)return void TcHmi.Log.warnEx("Element input.no-sync-unit not found.");noSyncUnit.addEventListener("change",()=>{this.__master.selectedSyncUnit=null,this.__master.network.drawMatrix()}),null===selectedSyncUnit&&(noSyncUnit.checked=!0);let syncUnitIndex=0;for(const[syncUnitId,syncUnit]of syncUnits.entries()){{const row_syncUnit=document.createElement("tr"),radioButton=document.createElement("input");radioButton.setAttribute("type","radio"),radioButton.setAttribute("name","selectSyncUnit"),radioButton.setAttribute("id",`syncunitname${syncUnitIndex}`),null!=selectedSyncUnit&&selectedSyncUnit===syncUnitId&&radioButton.setAttribute("checked","checked");const selectSyncUnitFn=()=>{this.__master.selectedSyncUnit=syncUnitId,this.__master.network.drawMatrix()},col_radioButton=document.createElement("td");col_radioButton.appendChild(radioButton),radioButton.addEventListener("change",selectSyncUnitFn);const col_name=document.createElement("label");col_name.style.display="table-cell",col_name.style.verticalAlign="middle";const syncUnitName=document.createElement("span");syncUnitName.classList.add("bold"),col_name.setAttribute("for",`syncunitname${syncUnitIndex}`),localization.addElement(syncUnitName,"Sync_Unit_Name",[syncUnitIndex]);const syncUnitSlavesCount=document.createElement("span");syncUnitSlavesCount.classList.add("round-brackets"),localization.addElement(syncUnitSlavesCount,"Sync_Unit_Slaves_Count",[syncUnit.slaves.length]),col_name.append(syncUnitName,syncUnitSlavesCount);const col_wcFaultCounter=document.createElement("td"),col_framesMissedCount=document.createElement("td");row_syncUnit.append(col_radioButton,col_name,col_wcFaultCounter,col_framesMissedCount),content_syncunit_list.appendChild(row_syncUnit)}for(const slave of syncUnit.slaves){const row_slave=document.createElement("tr"),col_radioButton=document.createElement("td"),col_name=document.createElement("td"),col_wcFaultCounter=document.createElement("td");col_wcFaultCounter.classList.add("error-value","text-align-right");const col_framesMissedCount=document.createElement("td");col_framesMissedCount.classList.add("error-value","text-align-right"),col_name.textContent=slave.name,col_wcFaultCounter.textContent="0",row_slave.appendChild(col_radioButton),row_slave.appendChild(col_name),row_slave.appendChild(col_wcFaultCounter),row_slave.appendChild(col_framesMissedCount),content_syncunit_list.appendChild(row_slave),addDomElement("ExtendedInfoOfMaster",slave.onlineData.syncUnits.get(syncUnitId)?.faultCounter,col_wcFaultCounter),addDomElement("ExtendedInfoOfMaster",slave.onlineData.syncUnits.get(syncUnitId)?.framesMissedCount,col_framesMissedCount)}syncUnitIndex++}content.querySelector(".master-netId").textContent=this.__master.netId,content.setTitle(localization,"Master_View_Title"),super.__open(content)}updateDrawings(){return!0}createSlaveList(){const firstSlave=this.__master.ports[1].nextSlave;if(!firstSlave)return;const container=document.querySelector(".slave-list");if(!container)return;if(!this.__popUp)return;const slavesContent=this.__popUp.querySelector('.tab-content[name="slaves"]');slavesContent&&(slavesContent.appendChild(container),firstSlave instanceof Slave&&this.__slaveListRecursive(firstSlave,0,container))}__slaveListRecursive(slave,treeDepth,container){const row=document.createElement("tr");row.setAttribute("tree-depth",`${treeDepth}`);const nameEl=document.createElement("td");nameEl.textContent=slave.name,nameEl.style.marginLeft=20*treeDepth+"px";const typeEl=document.createElement("td");typeEl.textContent=slave.staticInfo.identity.type.value,row.append(nameEl,typeEl),container.append(row);let hasSubTree=!1;const ebusPort=slave.outgoingConfiguredEBusPort;for(const port of slave.cableLinkPorts){const nextSlave=port.nextSlave;nextSlave&&(ebusPort?(hasSubTree=!0,this.__slaveListRecursive(nextSlave,treeDepth+1,container)):this.__slaveListRecursive(nextSlave,treeDepth,container))}if(ebusPort){const nextSlave=ebusPort.nextSlave;nextSlave&&(slave.hasIncomingCableLinkPort?(hasSubTree=!0,this.__slaveListRecursive(nextSlave,treeDepth+1,container)):this.__slaveListRecursive(nextSlave,treeDepth,container))}hasSubTree?(nameEl.addEventListener("click",()=>{nameEl.classList.toggle("arrow-3");let nextSibling=row.nextElementSibling;for(;nextSibling;){const currentSibling=nextSibling,currentSibling_treeDepth=parseInt(currentSibling.getAttribute("tree-depth"),10);if(treeDepth>=currentSibling_treeDepth)break;if(currentSibling.classList.toggle("hide"),nextSibling=currentSibling.nextElementSibling,!nextSibling)break}}),nameEl.classList.add("arrow")):nameEl.classList.add("arrow-placeholder")}}export class ExtendedInfoOfSlave extends ExtendedInfo{__slave;__slaveDrawing=null;__traceDrawing=null;constructor(slave){super(slave.master,"Slave"),this.__slave=slave,this.__open()}destroy(){super.destroy(),this.__master.removeExtendedInfoOfSlave(this),this.__slaveContentTabs?.remove(),this.__slaveContentTabs=null,this.__popup_param?.content?.remove(),this.__popup_param=null,this.__slaveDrawing?.destroy(),this.__slaveDrawing=null,this.__traceDrawing?.destroy(),this.__traceDrawing=null,removeGarbageElements("ExtendedInfoOfSlave"),this.__master.target.main.getLocalization().cleanUp()}__slaveContentTabs=null;__open(){const content=this.__slave.main.getTemplate("popup-slave"),localization=this.__master.target.main.getLocalization();if(!content)return void TcHmi.Log.warn("Template 'popup-slave' was not found.");if(this.__slaveContentTabs=content.querySelector("tchmi-content-tabs"),!this.__slaveContentTabs)return void TcHmi.Log.warn("Element 'tchmi-content-tabs' not found");this.__slaveContentTabs.addTabChangeCallback(tabName=>{this.__master.setExtendedInfoTabName("Slave",tabName)}),this.__tabName&&this.__slaveContentTabs.openTab(this.__tabName),content.setTitle(localization,"Slave_View_Title"),this.__popup_param={content},super.__open(content);const traceTable=content.querySelector(".trace-table");if(!traceTable)return void TcHmi.Log.warn("Element with class .trace-table does not exist.");const traceTable_head=traceTable.querySelector(".head");if(!traceTable_head)return void TcHmi.Log.warn("Element with class .head does not exist.");const traceTable_content=traceTable.querySelector(".content");if(!traceTable_content)return void TcHmi.Log.warn("Element with class .content does not exist.");const traceDrawingWrapper=content.querySelector(".trace-drawing-wrap");if(!traceDrawingWrapper)return void TcHmi.Log.warn("Element with class .trace-drawing-wrap does not exist.");const traceTableRows=[{name:"slaveName",contentKey:"Slave_View_EtherCAT_General_Name",static:!0},{name:"abnormalChanges",contentKey:"Slave_Abnormal_State_Changes",static:!1},{name:"connectionLosses",contentKey:"Slave_Connection_Losses",static:!1},{name:"crc",contentKey:"Slave_CRC_Error",sub:["A","D","B","C"],static:!1}];for(const row of traceTableRows){const headCell=document.createElement("div");headCell.setAttribute("row",row.name);const headCellContent=document.createElement("span");if(localization.addElement(headCellContent,row.contentKey),headCell.append(headCellContent),traceTable_head.append(headCell),"sub"in row)for(let subRowIndex=0;subRowIndex<row.sub.length;subRowIndex++){const subRow=row.sub[subRowIndex],headCell_sub=document.createElement("div");headCell_sub.textContent=subRow,0===subRowIndex?(headCell_sub.style.float="right",headCell.prepend(headCell_sub)):(headCell_sub.style.textAlign="right",traceTable_head.append(headCell_sub))}}const trace=this.__slave.trace;if(trace){const traceScale=.5,traceDimension={width:trace.dimension.width,height:trace.dimension.height};traceDimension.height+=200,traceDrawingWrapper.style.width=traceDimension.width*traceScale+"px",traceDrawingWrapper.style.height=traceDimension.height*traceScale+"px",traceDrawingWrapper.style.position="absolute",this.__traceDrawing=new DrawingTrace(trace),traceDrawingWrapper.append(this.__traceDrawing),this.__traceDrawing.setInitialDimension(traceDimension),this.__traceDrawing.setZoomLevel(traceScale),this.__traceDrawing.initDrawing(),traceTable_head.style.paddingTop=traceDimension.height*traceScale+"px",this.__traceDrawing.update();for(const traceSlave of trace.slaves){const cellWidth=traceSlave.design.dimension.width*traceScale,col=document.createElement("div");col.classList.add("col"),col.style.minWidth=`${cellWidth}px`,col.style.maxWidth=`${cellWidth}px`,col.style.paddingTop=traceDimension.height*traceScale+"px",col.addEventListener("click",()=>{traceSlave.master.setExtendedInfoOfSlave(new ExtendedInfoOfSlave(traceSlave))});const index=this.__slave.index;traceSlave.index===index&&col.classList.add("trace-slave-highlight");for(const row of traceTableRows)if("sub"in row)for(let subRowIndex=0;subRowIndex<row.sub.length;subRowIndex++){const port=traceSlave.getPortByIndex(subRowIndex),cell=document.createElement("div");cell.setAttribute("row",row.name),cell.textContent="-",cell.classList.add("error-value","no-value"),col.appendChild(cell),row.static||addDomElement("ExtendedInfoOfSlave",port.online.counter[row.name]?.total,cell)}else{const cell=document.createElement("div");if(cell.setAttribute("row",row.name),cell.textContent="-","slaveName"===row.name){cell.classList.add("justify-content-center"),cell.textContent="";const label=document.createElement("div");label.classList.add("trace-table-slave-name"),label.textContent=traceSlave.name,cell.appendChild(label)}else cell.classList.add("error-value","no-value");col.appendChild(cell),row.static||addDomElement("ExtendedInfoOfSlave",traceSlave.onlineData.counter[row.name],cell)}traceTable_content.appendChild(col)}const slaveNameElements=document.querySelectorAll('[row="slaveName"]');let reqHeight=0;for(const el of slaveNameElements)el.offsetHeight>reqHeight&&(reqHeight=el.offsetHeight);for(const el of slaveNameElements)el.style.height=`${reqHeight}px`}const slaveEtherCAT=this.__slave.data.EtherCAT,slaveView=content.querySelector(".slave-view");if(!slaveView)return void TcHmi.Log.warn("Element '.slave-view' not found.");const slaveName=slaveView.querySelector(".name");if(!slaveName)return void TcHmi.Log.warn("Element '.name' not found.");const slaveViewContent=slaveView.querySelector("tchmi-tab-contents");if(!slaveViewContent)return void TcHmi.Log.warn("slaveViewContent: Element 'tchmi-tab-contents' not found.");addDomElement("ExtendedInfoOfSlave",this.__slave.onlineData.messages,slaveView.querySelector(".text-msg"));const contentEtherCAT=slaveViewContent.querySelector('[name="EtherCAT"]'),contentEtherCAT_table=contentEtherCAT?.querySelector("table");contentEtherCAT_table&&(addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.name,contentEtherCAT_table.querySelector(".name")),addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.type,contentEtherCAT_table.querySelector(".type")),addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.vendor.memberNameLong,contentEtherCAT_table.querySelector(".memberName")),contentEtherCAT_table.querySelector(".EtherCAT-addr").innerHTML=slaveEtherCAT.identity.addrs.phys.toString(),contentEtherCAT_table.querySelector(".auto-inc-addr").innerHTML=slaveEtherCAT.identity.addrs.autoInc.toString(),addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.vendor.id,contentEtherCAT_table.querySelector(".vendor")),addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.product,contentEtherCAT_table.querySelector(".product")),addDomElement("ExtendedInfoOfSlave",slaveEtherCAT.identity.revision,contentEtherCAT_table.querySelector(".revision")));const onlineData=this.__slave.onlineData,contentOnline=slaveViewContent.querySelector('[name="online"]');if(!contentOnline)return void TcHmi.Log.warn('Element [tab="online"] not found.');addDomElement("ExtendedInfoOfSlave",onlineData.current.stateMachine.name,contentOnline.querySelector(".currentState"));const slaveSetStateValue=content.querySelector('[name="slave-setState-value"]'),slaveSetStateBtn=content.querySelector('[name="slave-setState-btn"]');slaveSetStateValue&&slaveSetStateBtn&&(slaveSetStateBtn.init(this.__master.main),slaveSetStateBtn.addEventListener("click",()=>{parseInt(slaveSetStateValue.value,10)&&this.__master.target.main.comObj?.writeSymbol(`${extensionName}.SetSlaveStateMachine`,{device:this.__master.main.config.device,slaveAddr:this.__slave.addr,state:parseInt(slaveSetStateValue.value,10)},()=>{slaveSetStateValue.value="0"},{button:slaveSetStateBtn})})),addDomElement("ExtendedInfoOfSlave",onlineData.counter.abnormalChanges,contentOnline.querySelector(".abnormalChanges")),addDomElement("ExtendedInfoOfSlave",onlineData.counter.connectionLosses,contentOnline.querySelector(".connectionLosses"));const elPorts=slaveViewContent.querySelector('[name="ports"]');if(!elPorts)return void TcHmi.Log.warn("Element '.ports' not found.");elPorts.classList.add("online-values");for(const port of this.__slave.ports)if(port.physic!==PortPhysic.NONE){let configuredComponent=port.configuredComponent;const elPort=document.createElement("div");elPort.classList.add("port");{const portTitle=document.createElement("div");portTitle.classList.add("port-title"),portTitle.setAttribute("colspan","2");const portName=document.createElement("span");if(portName.classList.add("port-name"),portTitle.append(portName),localization.addElement(portName,"Port_Name",[PortName[port.index]]),port.redundancy){const labelRedundancyPort=document.createElement("span");labelRedundancyPort.classList.add("round-brackets"),portTitle.append(labelRedundancyPort),localization.addElement(labelRedundancyPort,"Port_Redundancy"),configuredComponent=port?.connection?.inPort?.component??null}else if(port.configured){const labelPortConfigured=document.createElement("span");labelPortConfigured.classList.add("round-brackets"),portTitle.append(labelPortConfigured),localization.addElement(labelPortConfigured,"Port_Configured")}else if(configuredComponent instanceof Master){const labelPortFirstInNetwork=document.createElement("span");labelPortFirstInNetwork.classList.add("round-brackets"),portTitle.append(labelPortFirstInNetwork),localization.addElement(labelPortFirstInNetwork,"Port_First_In_Network")}else{const labelPortNotConfigured=document.createElement("span");labelPortNotConfigured.classList.add("round-brackets"),portTitle.append(labelPortNotConfigured),localization.addElement(labelPortNotConfigured,"Port_Not_Configured"),elPort.classList.add("not-connected")}elPort.append(portTitle)}{const row=document.createElement("div");row.classList.add("row"),row.classList.add("errorMessage"),addDomElement("ExtendedInfoOfSlave",port.online.messages,row),elPort.appendChild(row)}{const row=document.createElement("div");row.classList.add("row");const portTypeLabel=document.createElement("div");localization.addElement(portTypeLabel,"Port_Type");const portType=document.createElement("div");portType.textContent=port.typeName,row.append(portTypeLabel,portType),elPort.appendChild(row)}if(configuredComponent){const row=document.createElement("div");row.classList.add("row");const configuredComponentLabel=document.createElement("div"),cell=document.createElement("div");if(cell.classList.add("navigation-link"),cell.innerHTML=configuredComponent.name,configuredComponent instanceof Slave){const configuredSlave=configuredComponent;localization.addElement(configuredComponentLabel,"Port_Configured_Slave"),cell.addEventListener("click",()=>{this.__master.setExtendedInfoOfSlave(new ExtendedInfoOfSlave(configuredSlave))})}else if(configuredComponent instanceof Master){const configuredMaster=configuredComponent;localization.addElement(configuredComponentLabel,"Port_Configured_Master"),cell.addEventListener("click",()=>{this.__master.setExtendedInfoOfMaster(new ExtendedInfoOfMaster(configuredMaster))})}row.append(configuredComponentLabel,cell),elPort.append(row)}{const row=document.createElement("div");row.classList.add("row");const crcErrorLabel=document.createElement("div");localization.addElement(crcErrorLabel,"Slave_CRC_Error");const elCrcValue=document.createElement("div");addDomElement("ExtendedInfoOfSlave",port.online.counter.crc.total,elCrcValue),elCrcValue.classList.add("error-value","no-value"),elCrcValue.textContent="-",row.append(crcErrorLabel,elCrcValue),elPort.append(row)}document.createElement("td").textContent=port.typeName,elPorts.append(elPort)}const processDataView=new ProcessDataView(this.__slave,localization);slaveView.append(processDataView);const slaveDrawingWrapper=slaveView.querySelector(".slave-drawing-wrapper");slaveDrawingWrapper&&(this.__slaveDrawing=new DrawingSlave(this.__slave),slaveDrawingWrapper.append(this.__slaveDrawing)),slaveName.textContent=slaveEtherCAT.identity.name.value,this.__master.updateMasterOnlineInfo(null),this.__master.updateSlavesOnlineInfo(null)}updateDrawings(){return!(!this.__traceDrawing||!this.__slaveDrawing)&&(this.__traceDrawing.update(),this.__slaveDrawing.update(),!0)}}